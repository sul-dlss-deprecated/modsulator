#!/usr/bin/env ruby

require 'modsulator'

unless ARGV.length == 1
  abort "Usage: modsulator <spreadsheet>"
end

unless (File.exists?(ARGV[0]) && File.readable?(ARGV[0]))
  abort "*** The file #{ARGV[0]} does not exist or is not readable to the current user? - Terminating."
end

modsulator = Modsulator.new(File.new(ARGV[0]), File.basename(ARGV[0]))
xml_string = modsulator.convert_rows()

puts xml_string
